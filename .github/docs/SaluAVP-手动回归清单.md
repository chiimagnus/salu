# SaluAVP 手动回归清单（visionOS Simulator）

> 目的：在不依赖存档/回放的前提下，覆盖 SaluAVP 当前已实现的核心玩法闭环，避免“功能能跑但交互/路由/动画回归”。

## 0. 前置条件

- 构建通过：`xcodebuild -project SaluNative/SaluNative.xcodeproj -scheme SaluAVP -destination 'platform=visionOS Simulator,name=Apple Vision Pro' build`
- 约定：本清单不包含存档/读档/Continue、trace/replay（已明确不做）。

## 1. 启动与路由（控制面板 → Immersive）

- 打开 `SaluAVP`。
- 在 2D 控制面板点击 `New Run`（可用固定 seed，便于复现）。
- 点击 `Show Immersive` 进入 ImmersiveSpace。
- 退出 ImmersiveSpace 再进入一次，确认不会崩溃，且 run 状态仍可继续推进。

## 2. 地图推进（Map Loop）

- 地图节点具备至少三态可视反馈：可达 / 当前 / 已完成（或等价状态）。
- 只能点击可达节点；点击不可达节点无响应或有明确反馈。
- 完成一个房间后回到地图，且正确解锁下一层可达节点。
- 推进到 Boss 节点并完成，确认：
  - Act1/Act2：进入下一幕地图（floor 增长）。
  - Act3：出现通关收束（run won）。

## 3. 战斗（动画闭环 + 多敌人 + 目标选择）

- 进入普通战斗：
  - 回合开始能看到抽牌动画（或至少可感知的抽牌过程）并进入手牌区。
  - 打出卡牌：卡牌从手牌进入弃牌堆/消耗堆的动画连续且无明显跳帧。
  - 伤害/格挡反馈可见（飘字、抖动、音效/粒子任一即可）。
  - 击杀敌人：敌人死亡反馈可见且不会导致整个战斗场景重建。
- 多敌人战斗：
  - 可明确选中目标（高亮/描边/抬升任一）并出牌命中正确敌人。
  - 在多敌人时，对需要目标的牌：不选择目标无法出牌（有明确提示）。
- 结束回合：
  - 手牌弃置、敌人行动、进入下一回合流程正确。

## 4. 房间：休息点（Rest）

- 进入休息点：
  - 有明确的交互入口（3D 可点或 2D HUD 均可）。
  - 回血行为生效且数值更新正确。
  - 升级卡牌入口（若已实现）：升级结果在后续战斗生效。
- 离开休息点回到地图，Immersive 保持开启（不应因为离开房间就退出 Immersive）。

## 5. 房间：事件（Event）

- 进入事件房间：
  - 出现事件内容（可为 2D 面板），可选择至少一个选项并对 run 产生可观察变化（金币/HP/卡牌/遗物等）。
  - 对需要二次选择的事件：能进入 follow-up 并完成选择后正常返回地图。
- 若事件触发战斗：战斗结束后回到事件/奖励链路符合当前设计（不跳转错路由）。

## 6. 房间：商店（Shop，3D 场景 + 2D 商品信息面板）

- 进入商店后，商店的核心内容在 3D 场景中（离开商店仍保持 Immersive）。
- 点击某个商品一次：
  - 只更新“商品信息 2D 面板”（建议右侧/右上角位置），不应导致整个商店场景刷新重建。
  - 面板显示该商品的信息，并提供明确的 `购买` 按钮。
- 点击不同商品：
  - 只切换面板内容，不应出现“购买成功”残留弹窗或错误提示串场。
- 购买流程：
  - 点击 `购买` 后才会购买；购买成功会扣金币并更新 deck/遗物/消耗品（按商品类型）。
  - 购买成功后仍停留在商店房间（不应自动退出回到地图）。
  - 余额不足时提示明确，且不会产生误购买/误提示。
- 离开商店：
  - 通过商店中的离开入口回到地图，节点完成逻辑正确。

## 7. 奖励链路（普通/精英/Boss）

- 普通战斗胜利：
  - 获得金币（可通过 UI/摘要确认变化）。
  - 进入卡牌奖励选择；选择 1 张会加入牌组，跳过则不加入。
- 精英战斗胜利：
  - 在普通奖励基础上，出现遗物奖励（可拿/可跳过），拿到后后续战斗生效。
- Boss 战斗胜利：
  - 走完奖励链路后进入章节收束（Act1/2 进入下一幕；Act3 通关）。

## 8. Removed Legacy（每批次必填）

> 在每次阶段性变更后，把“删了什么旧逻辑、为何可删、如何验证无回归”补在这里，便于 review。

- [ ] 本批删除项：
- [ ] 验证方式（对应本清单条目编号）：

