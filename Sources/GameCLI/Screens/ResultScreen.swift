import Foundation
import GameCore

/// æˆ˜æ–—ç»“æœç•Œé¢
enum ResultScreen {
    
    // MARK: - èƒœåˆ©ç•Œé¢
    
    static func showVictory(state: BattleState) {
        Terminal.clear()
        print("""
        \(Terminal.green)\(Terminal.bold)
        
        
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘                                                       â•‘
        â•‘     â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â•‘
        â•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•‘
        â•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ•â• â•‘
        â•‘     â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—    â•‘
        â•‘      â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•— â•‘
        â•‘       â•šâ•â•â•â•  â•šâ•â• â•šâ•â•â•â•â•â•   â•šâ•â•    â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â• â•‘
        â•‘                                                       â•‘
        â•‘                  ğŸ† \(L10n.text("æˆ˜ æ–— èƒœ åˆ©", "VICTORY")) ğŸ†                    â•‘
        â•‘                                                       â•‘
        â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
        â•‘                                                       â•‘
        â•‘         \(L10n.text("å‰©ä½™ HP", "HP Left"))ï¼š\(String(format: "%3d", state.player.currentHP))/\(state.player.maxHP)                            â•‘
        â•‘         \(L10n.text("æˆ˜æ–—å›åˆ", "Turns"))ï¼š\(String(format: "%3d", state.turn))                              â•‘
        â•‘                                                       â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        \(Terminal.reset)
        """)
    }
    
    // MARK: - å¤±è´¥ç•Œé¢
    
    static func showDefeat(state: BattleState) {
        Terminal.clear()
        print("""
        \(Terminal.red)\(Terminal.bold)
        
        
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘                                                       â•‘
        â•‘      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•‘
        â•‘      â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â•‘
        â•‘      â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â•‘
        â•‘      â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â•‘
        â•‘      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â•‘
        â•‘      â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•   â•šâ•â•   â•‘
        â•‘                                                       â•‘
        â•‘                  ğŸ’€ \(L10n.text("æˆ˜ æ–— å¤± è´¥", "DEFEAT")) ğŸ’€                    â•‘
        â•‘                                                       â•‘
        â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
        â•‘                                                       â•‘
        â•‘         \(L10n.text("åšæŒå›åˆ", "Turns Survived"))ï¼š\(String(format: "%3d", state.turn))                              â•‘
        â•‘                                                       â•‘
        â•‘              \(L10n.text("å†æ¥å†å‰ï¼ä¸‹æ¬¡ä¸€å®šï¼", "You'll get it next time!"))                     â•‘
        â•‘                                                       â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        \(Terminal.reset)
        """)
    }
    
    // MARK: - æœ€ç»ˆç»“æœç•Œé¢ï¼ˆå«ç»Ÿè®¡ï¼‰
    
    static func showFinal(state: BattleState, record: BattleRecord? = nil) {
        if state.playerWon == true {
            showVictory(state: state)
        } else {
            showDefeat(state: state)
        }
        
        // æ˜¾ç¤ºæˆ˜ç»©ç»Ÿè®¡
        if let record = record {
            print()
            print("        \(Terminal.dim)â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®\(Terminal.reset)")
            print("        \(Terminal.dim)â”‚ ğŸ“Š \(L10n.text("æœ¬å±€ç»Ÿè®¡", "Run Stats"))                          â”‚\(Terminal.reset)")
            print("        \(Terminal.dim)â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\(Terminal.reset)")
            print("        \(Terminal.dim)â”‚ \(L10n.text("æ‰“å‡ºå¡ç‰Œ", "Cards Played")): \(String(format: "%-3d", record.cardsPlayed))                          â”‚\(Terminal.reset)")
            print("        \(Terminal.dim)â”‚ \(L10n.text("é€ æˆä¼¤å®³", "Damage Dealt")): \(String(format: "%-3d", record.totalDamageDealt))  \(L10n.text("è·å¾—æ ¼æŒ¡", "Block Gained")): \(String(format: "%-3d", record.totalBlockGained))        â”‚\(Terminal.reset)")
            print("        \(Terminal.dim)â”‚ \(L10n.text("å—åˆ°ä¼¤å®³", "Damage Taken")): \(String(format: "%-3d", record.totalDamageTaken))                          â”‚\(Terminal.reset)")
            print("        \(Terminal.dim)â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯\(Terminal.reset)")
        }
        
        // æ˜¾ç¤ºç´¯è®¡èƒœç‡ (P6: temporarily disabled - requires historyService injection)
        // let stats = historyService.getStatistics()
        // if stats.totalBattles > 0 {
        //     print()
        //     print("        \(Terminal.cyan)ğŸ“ˆ ç´¯è®¡æˆ˜ç»©: \(stats.wins)èƒœ \(stats.losses)è´Ÿ (èƒœç‡ \(String(format: "%.1f", stats.winRate))%)\(Terminal.reset)")
        // }
        
        print()
        print("        \(Terminal.dim)\(L10n.text("ä½¿ç”¨ --history æŸ¥çœ‹å†å²è®°å½•", "Use --history to view history"))\(Terminal.reset)")
        print("        \(Terminal.dim)\(L10n.text("ä½¿ç”¨ --stats æŸ¥çœ‹è¯¦ç»†ç»Ÿè®¡", "Use --stats to view statistics"))\(Terminal.reset)")
    }
    
    // MARK: - é€€å‡ºç•Œé¢
    
    static func showExit() {
        Terminal.clear()
        print("""
        \(Terminal.magenta)
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘                                                       â•‘
        â•‘           ğŸ‘‹ \(L10n.text("æ„Ÿè°¢æ¸¸ç© SALUï¼", "Thanks for playing SALU!"))                          â•‘
        â•‘                                                       â•‘
        â•‘              \(L10n.text("æœŸå¾…ä¸‹æ¬¡å†è§ï¼", "See you next time!"))                           â•‘
        â•‘                                                       â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        \(Terminal.reset)
        """)
    }
}
