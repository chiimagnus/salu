---
description: Salu 游戏业务说明 - 游戏规则、数值设定、扩展计划
alwaysApply: false
---
# Salu - 杀戮尖塔 CLI 仿制版

## 项目简介

Salu 是一个跨平台（macOS/Windows）的纯 CLI 回合制卡牌战斗游戏，灵感来自《杀戮尖塔》（Slay the Spire）。

## 快速开始

```bash
# 运行游戏（使用固定种子，可复现）
swift run GameCLI --seed 1

# 运行游戏（随机种子）
swift run GameCLI

# 运行测试
./Scripts/test_game.sh
```

---

## 游戏规则

### 战斗目标

击败敌人（将敌人 HP 降为 0）即为胜利，玩家 HP 降为 0 则失败。

### 回合流程

```
回合开始
├── 能量恢复至 3
├── 玩家格挡清零
├── 抽 5 张牌
└── 显示敌人意图

玩家阶段
├── 选择打出手牌（消耗能量）
├── 或选择结束回合
└── 重复直到结束回合

回合结束
├── 弃掉所有手牌
├── 敌人执行行动
└── 进入下一回合
```

### 卡牌系统

| 卡牌 | 费用 | 效果 |
|------|------|------|
| Strike | 1 能量 | 造成 6 伤害 |
| Defend | 1 能量 | 获得 5 格挡 |

初始牌组：Strike × 5 + Defend × 5 = 10 张

### 牌堆机制

- **抽牌堆（Draw Pile）**：每回合从这里抽牌
- **手牌（Hand）**：当前可使用的卡牌
- **弃牌堆（Discard Pile）**：用过的牌进入这里
- **洗牌**：抽牌堆空时，弃牌堆洗回抽牌堆

### 伤害与格挡

```
伤害结算顺序：
1. 伤害先被格挡吸收
2. 超出格挡的部分扣除 HP
3. 格挡每回合开始时清零
```

示例：
- 玩家有 5 格挡，受到 7 伤害
- 5 格挡被消耗，实际受到 2 点 HP 伤害

---

## 数值设定

### 玩家属性

| 属性 | 数值 |
|------|------|
| 初始 HP | 80 |
| 每回合能量 | 3 |
| 每回合抽牌 | 5 |

### 敌人属性

| 属性 | 数值 |
|------|------|
| 名称 | 下颚虫 |
| HP | 42 |
| 行动 | 每回合攻击 7 |

---

## 操作指南

### 主菜单

| 输入 | 操作 |
|------|------|
| `1` | 开始战斗 |
| `2` | 设置 / 战绩 |
| `3` | 退出游戏 |

### 战斗中

| 输入 | 操作 |
|------|------|
| `1` ~ `n` | 打出第 n 张手牌 |
| `0` | 结束回合 |
| `h` | 显示帮助 |
| `q` | 返回主菜单 |

### 界面说明

```
┌─────────────────────────────────────┐
│ 👹 下颚虫: ❤️ 42/42                  │  ← 敌人状态
├─────────────────────────────────────┤
│ 🧑 铁甲战士: ❤️ 80/80 🛡️ 5           │  ← 玩家状态
│ 能量：⚡ 3/3                         │  ← 当前能量
├─────────────────────────────────────┤
│ 🃏 手牌：                            │
│     ✓ [1] Strike (1能量) - 造成6伤害 │  ← ✓ 表示可用
│     ✗ [2] Defend (1能量) - 获得5格挡 │  ← ✗ 表示能量不足
├─────────────────────────────────────┤
│ 📚 抽牌堆：5 | 🗑️ 弃牌堆：3           │  ← 牌堆信息
└─────────────────────────────────────┘
```

---

## 命令行参数

| 参数 | 说明 |
|------|------|
| `--seed N` | 固定随机种子（可复现） |
| `--history` / `-H` | 查看历史战绩 |
| `--stats` / `-S` | 查看详细统计 |

```bash
# 使用固定种子（可复现）
swift run GameCLI --seed 42

# 查看历史战绩
swift run GameCLI --history

# 查看统计数据
swift run GameCLI --stats
```

---

## 战绩系统

战斗结束后自动记录：
- 胜负结果、回合数
- 使用卡牌统计
- 伤害/格挡统计

数据存储位置：
- **macOS**: `~/Library/Application Support/Salu/battle_history.json`
- **Linux**: `~/.salu/battle_history.json`
- **Windows**: `%LOCALAPPDATA%\Salu\battle_history.json`

---

## 未来扩展计划

### Phase 1：新卡牌

| 卡牌 | 费用 | 效果 |
|------|------|------|
| Bash | 2 能量 | 造成 8 伤害，给予易伤 2 |
| Pommel Strike | 1 能量 | 造成 7 伤害，抽 1 张牌 |
| Shrug It Off | 1 能量 | 获得 8 格挡，抽 1 张牌 |

### Phase 2：状态效果

| 效果 | 说明 |
|------|------|
| Vulnerable（易伤） | 受到伤害 +50% |
| Weak（虚弱） | 造成伤害 -25% |
| Strength（力量） | 攻击伤害 +N |

### Phase 3：多敌人战斗

- 支持同时面对多个敌人
- 添加目标选择机制
- 不同敌人有不同 AI 模式

### Phase 4：更多内容

- 卡牌升级系统
- 遗物系统
- 事件系统
- 地图路线
- 存档系统
