---
description: GameCLI æ¨¡å—å¼€å‘è§„èŒƒ - è¡¨ç°å±‚
globs: Sources/GameCLI/**/*.swift
alwaysApply: true
---

# GameCLI æ¨¡å—å¼€å‘è§„èŒƒ

## æ¨¡å—å®šä½

GameCLI æ˜¯**è¡¨ç°å±‚**ï¼Œè´Ÿè´£ç»ˆç«¯ç•Œé¢æ¸²æŸ“ã€ç”¨æˆ·è¾“å…¥å¤„ç†ã€‚

```
Sources/GameCLI/  â† æœ¬è§„èŒƒé€‚ç”¨èŒƒå›´
â”‚
â”œâ”€â”€ Screens/                    # âœ… ç•Œé¢ç³»ç»Ÿ
â”‚   â”œâ”€â”€ MainMenuScreen.swift    # ä¸»èœå•ç•Œé¢
â”‚   â”œâ”€â”€ SettingsScreen.swift    # è®¾ç½®èœå•ç•Œé¢
â”‚   â”œâ”€â”€ HelpScreen.swift        # å¸®åŠ©ç•Œé¢
â”‚   â”œâ”€â”€ BattleScreen.swift      # æˆ˜æ–—ä¸»ç•Œé¢æ¸²æŸ“
â”‚   â”œâ”€â”€ ResultScreen.swift      # æˆ˜æ–—ç»“æœç•Œé¢
â”‚   â”œâ”€â”€ HistoryScreen.swift     # å†å²è®°å½•ç•Œé¢
â”‚   â”œâ”€â”€ StatisticsScreen.swift  # ç»Ÿè®¡æ•°æ®ç•Œé¢
â”‚   â”œâ”€â”€ MapScreen.swift         # ğŸ”œ åœ°å›¾ç•Œé¢ï¼ˆè®¡åˆ’ä¸­ï¼‰
â”‚   â”œâ”€â”€ RewardScreen.swift      # ğŸ”œ å¥–åŠ±é€‰æ‹©ç•Œé¢ï¼ˆè®¡åˆ’ä¸­ï¼‰
â”‚   â”œâ”€â”€ ShopScreen.swift        # ğŸ”œ å•†åº—ç•Œé¢ï¼ˆè®¡åˆ’ä¸­ï¼‰
â”‚   â””â”€â”€ EventScreen.swift       # ğŸ”œ äº‹ä»¶ç•Œé¢ï¼ˆè®¡åˆ’ä¸­ï¼‰
â”‚
â”œâ”€â”€ Components/                 # âœ… UI ç»„ä»¶
â”‚   â””â”€â”€ EventFormatter.swift    # äº‹ä»¶ â†’ å½©è‰²æ–‡æœ¬
â”‚
â”œâ”€â”€ AI/                         # ğŸ”œ AI å®ç°ï¼ˆè®¡åˆ’ä¸­ï¼‰
â”‚   â”œâ”€â”€ OpenAIProvider.swift    # OpenAI API
â”‚   â”œâ”€â”€ ClaudeProvider.swift    # Claude API
â”‚   â”œâ”€â”€ LocalLLMProvider.swift  # æœ¬åœ° LLM
â”‚   â””â”€â”€ MockAIProvider.swift    # æµ‹è¯•ç”¨ Mock
â”‚
â”œâ”€â”€ GameCLI.swift               # âœ… ä¸»å…¥å£ã€æ¸¸æˆå¾ªç¯
â”œâ”€â”€ Terminal.swift              # âœ… ANSI æ§åˆ¶ç ã€ç»ˆç«¯å·¥å…·
â”œâ”€â”€ Screens.swift               # âœ… ç•Œé¢ç»Ÿä¸€å…¥å£ï¼ˆå‘åå…¼å®¹å±‚ï¼‰
â””â”€â”€ HistoryManager.swift        # âœ… æˆ˜ç»©æŒä¹…åŒ–
```

> è¯´æ˜ï¼šâœ… å·²å®ç° | ğŸ”œ è®¡åˆ’ä¸­ï¼ˆè¯¦è§ `.cursor/plans/architecture-design.md`ï¼‰

---

## è®¾è®¡åŸåˆ™

### å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰

æ¯ä¸ªæ–‡ä»¶åªè´Ÿè´£ä¸€ä¸ªæ˜ç¡®çš„åŠŸèƒ½é¢†åŸŸï¼š

| æ–‡ä»¶ | å•ä¸€èŒè´£ | ç¦æ­¢æ··å…¥ |
|------|----------|----------|
| `Terminal.swift` | ç»ˆç«¯åº•å±‚æ§åˆ¶ | UI é€»è¾‘ã€ä¸šåŠ¡é€»è¾‘ |
| `EventFormatter.swift` | äº‹ä»¶ â†’ æ–‡æœ¬ | å±å¹•å¸ƒå±€ã€è¾“å…¥å¤„ç† |
| `ScreenRenderer.swift` | æˆ˜æ–—ç•Œé¢æ„å»º | èœå•é€»è¾‘ã€äº‹ä»¶æ ¼å¼åŒ– |
| `Screens.swift` | å…¨å±ç•Œé¢å±•ç¤º | æ¸¸æˆå¾ªç¯ã€çŠ¶æ€ç®¡ç† |
| `HistoryManager.swift` | æ–‡ä»¶è¯»å†™ | UI æ¸²æŸ“ |
| `GameCLI.swift` | æµç¨‹æ§åˆ¶ | å…·ä½“æ¸²æŸ“å®ç° |

### ç»„ä»¶åŒ–åŸåˆ™

1. **æ–°å¢ UI ç»„ä»¶æ—¶**ï¼šè€ƒè™‘æ˜¯å¦éœ€è¦ç‹¬ç«‹æ–‡ä»¶
2. **æ–‡ä»¶è¶…è¿‡ 300 è¡Œ**ï¼šè€ƒè™‘æ‹†åˆ†
3. **åŠŸèƒ½å¯å¤ç”¨æ—¶**ï¼šæŠ½å–ä¸ºç‹¬ç«‹ç»„ä»¶

```swift
// âœ… æ­£ç¡®ï¼šæŒ‰èŒè´£æ‹†åˆ†
// Terminal.swift - åº•å±‚å·¥å…·
// ScreenRenderer.swift - ç•Œé¢æ¸²æŸ“
// Screens.swift - å…¨å±ç•Œé¢

// âŒ é”™è¯¯ï¼šä¸€ä¸ªæ–‡ä»¶åŒ…å«æ‰€æœ‰ UI ä»£ç 
```

### ä¾èµ–æ–¹å‘

```
GameCLI.swift
    â†“ è°ƒç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Screens.swift     â”‚ ScreenRenderer.swift â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ è°ƒç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Terminal.swift  â”‚  EventFormatter.swift   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ å¯¼å…¥
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              GameCore                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ ¸å¿ƒçº¦æŸ

### å¿…é¡»éµå®ˆ

- âœ… é¢œè‰²è¾“å‡ºä½¿ç”¨ `Terminal` å¸¸é‡
- âœ… å±å¹•åˆ·æ–°ä½¿ç”¨æ¸…å±+é‡ç»˜æ¨¡å¼
- âœ… æ‰€æœ‰ç”¨æˆ·å¯è§æ–‡æœ¬ä½¿ç”¨ä¸­æ–‡
- âœ… æ¯ä¸ªæ–‡ä»¶èŒè´£å•ä¸€æ˜ç¡®

### ä¾èµ–å…³ç³»

```
GameCLI â†’ GameCore  âœ… å…è®¸
GameCore â†’ GameCLI  âŒ ç¦æ­¢
```

---

## æ–‡ä»¶èŒè´£è¯¦è§£

| æ–‡ä»¶ | èŒè´£ | å…¸å‹å†…å®¹ |
|------|------|----------|
| `GameCLI.swift` | å…¥å£ã€èœå•ã€æ¸¸æˆå¾ªç¯ | main(), mainMenuLoop(), gameLoop() |
| `Terminal.swift` | ANSI é¢œè‰²ç ã€å…‰æ ‡æ§åˆ¶ | clear(), é¢œè‰²å¸¸é‡ |
| `EventFormatter.swift` | BattleEvent â†’ å½©è‰²å­—ç¬¦ä¸² | format() |
| `ScreenRenderer.swift` | æ„å»ºæˆ˜æ–—ä¸»ç•Œé¢ | renderBattleScreen() |
| `Screens.swift` | å…¨å±ç•Œé¢ï¼ˆèœå•/å¸®åŠ©/ç»“æœï¼‰ | showMainMenu(), showHelp() |
| `HistoryManager.swift` | æˆ˜ç»© JSON è¯»å†™ | addRecord(), getRecords() |

---

## æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°ç•Œé¢

1. å¦‚æœæ˜¯å…¨å±ç•Œé¢ â†’ æ·»åŠ åˆ° `Screens.swift`
2. å¦‚æœæ˜¯æˆ˜æ–—å†…ç»„ä»¶ â†’ æ·»åŠ åˆ° `ScreenRenderer.swift`
3. å¦‚æœæ˜¯å…¨æ–°åŠŸèƒ½æ¨¡å— â†’ åˆ›å»ºæ–°æ–‡ä»¶

### æ·»åŠ æ–°èœå•é¡¹

1. åœ¨ `Screens.swift` æ›´æ–°èœå•æ˜¾ç¤º
2. åœ¨ `GameCLI.swift` æ·»åŠ è¾“å…¥å¤„ç†

### æ·»åŠ æ–°å‘½ä»¤è¡Œå‚æ•°

1. åœ¨ `GameCLI.main()` æ·»åŠ å‚æ•°æ£€æŸ¥
2. æ›´æ–° CLAUDE.mdc æ–‡æ¡£

---

## ç»ˆç«¯æ§åˆ¶

### é¢œè‰²ä½¿ç”¨

```swift
// ä½¿ç”¨ Terminal å¸¸é‡
print("\(Terminal.red)é”™è¯¯æ–‡æœ¬\(Terminal.reset)")
print("\(Terminal.bold)\(Terminal.green)æˆåŠŸ\(Terminal.reset)")

// å¯ç”¨é¢œè‰²
Terminal.red      // çº¢è‰²ï¼ˆæ•Œäººã€ä¼¤å®³ã€é”™è¯¯ï¼‰
Terminal.green    // ç»¿è‰²ï¼ˆç©å®¶ã€æˆåŠŸã€å¯ç”¨ï¼‰
Terminal.yellow   // é»„è‰²ï¼ˆèƒ½é‡ã€è­¦å‘Šã€æ„å›¾ï¼‰
Terminal.blue     // è“è‰²ï¼ˆç©å®¶åç§°ï¼‰
Terminal.cyan     // é’è‰²ï¼ˆæ ¼æŒ¡ã€å›åˆä¿¡æ¯ï¼‰
Terminal.magenta  // æ´‹çº¢ï¼ˆç‰¹æ®Šæ•ˆæœï¼‰
Terminal.bold     // åŠ ç²—
Terminal.dim      // æš—æ·¡
Terminal.reset    // é‡ç½®
```

### å±å¹•åˆ·æ–°

```swift
// æ¸…å±å¹¶åˆ·æ–°æ•´ä¸ªç•Œé¢
Terminal.clear()  // æ¸…å± + å…‰æ ‡å½’ä½
// ... æ‰“å°æ‰€æœ‰å†…å®¹ ...
Terminal.flush()  // åˆ·æ–°ç¼“å†²åŒº
```

---

## ç•Œé¢å¸ƒå±€

æˆ˜æ–—ä¸»ç•Œé¢å›ºå®šå¸ƒå±€ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ ‡é¢˜æ ï¼ˆå›åˆæ•°ã€ç§å­ï¼‰                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ•ŒäººåŒºåŸŸï¼ˆåç§°ã€HPæ¡ã€æ ¼æŒ¡ã€æ„å›¾ï¼‰              â”‚
â”œ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€â”¤
â”‚ ç©å®¶åŒºåŸŸï¼ˆåç§°ã€HPæ¡ã€æ ¼æŒ¡ã€èƒ½é‡ï¼‰              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ‰‹ç‰ŒåŒºåŸŸï¼ˆå¡ç‰Œåˆ—è¡¨ï¼‰                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç‰Œå †ä¿¡æ¯ï¼ˆæŠ½ç‰Œå †/å¼ƒç‰Œå †ï¼‰                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ äº‹ä»¶æ—¥å¿—ï¼ˆæœ€è¿‘6æ¡ï¼‰                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ¶ˆæ¯åŒºåŸŸï¼ˆé”™è¯¯æç¤ºç­‰ï¼‰                        â”‚
â”œâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”¤
â”‚ æ“ä½œæç¤ºæ                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ£€æŸ¥æ¸…å•

- [ ] é¢œè‰²ä½¿ç”¨ Terminal å¸¸é‡
- [ ] å±å¹•åˆ·æ–°ä½¿ç”¨æ¸…å±æ¨¡å¼
- [ ] ç•Œé¢å¸ƒå±€ä¿æŒä¸€è‡´
- [ ] æ–‡ä»¶èŒè´£å•ä¸€æ˜ç¡®
- [ ] æ–°ç»„ä»¶è€ƒè™‘å¤ç”¨æ€§
