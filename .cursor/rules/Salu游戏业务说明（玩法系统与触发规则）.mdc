---
description: Salu 游戏业务说明（玩法系统与触发规则）
alwaysApply: true
---

# Salu 游戏业务说明（玩法系统与触发规则）

本文档以**玩法/业务视角**说明 Salu 的系统、数值与触发时机，用于统一"游戏应该怎么表现/怎么结算"。

> **设定与剧情**请参阅：`.cursor/rules/Salu游戏设定与剧情（v0.1）.mdc`
> **卡牌/敌人/遗物命名映射**已整合到各业务章节（第 4/6/11 章）的表格中。

---

## 1. 游戏目标与核心循环

- **目标**：通过选择路线并在一系列房间中生存成长，最终击败最终 Boss 通关。
- **核心循环（当前版本已接入）**：
  - 进入战斗 → 胜利获得金币 → 选择卡牌奖励 → 继续推进地图
  - 进入事件（？）→ 选择事件选项（部分选项需要二次选择）→ 对本次冒险产生影响（金币/HP/卡牌/遗物等）
  - 进入商店 → 买卡 / 删牌（消耗金币）
  - 进入休息点 → 回血 / 升级卡牌
  - 精英/Boss 胜利 → 获得遗物（可跳过）→ 遗物效果在后续战斗生效

---

## 2. 冒险系统（地图推进）

### 2.1 地图结构

- **地图规模**：当前支持 **3 层（Act 1 → Act 2 → Act 3）** 的冒险骨架；每一层为一张 **15 层** 分支地图。
- **房间类型**：
  - 起点（进入时显示章节开场剧情）
  - 普通战斗
  - 精英战斗
  - 事件（？）
  - 休息点
  - 商店
  - Boss（胜利后显示章节收束/结局文本）

### 2.2 推进与解锁规则

- **触发：选择下一节点**
  - 玩家只能选择“当前可进入”的节点。
  - 进入节点后，执行该房间对应的玩法流程。
- **触发：节点完成**
  - 当前节点被标记为已完成。
  - 解锁与其相连的下一层节点。
  - 同一层的其他可选节点会变为不可进入（不能回头再选）。

### 2.3 通关与失败

- **触发：玩家生命值归零** → 冒险失败。
- **触发：击败 Boss**：
  - 若存在下一层（Act 1/Act 2）→ 进入下一层冒险
  - 若为最终层（Act 3）→ 冒险通关，显示最终结局

---

## 3. 玩家基础属性与初始资源

### 3.1 玩家基础属性

| 属性 | 数值 |
|------|------|
| 初始 HP | 80 |
| 每回合能量上限 | 3 |
| 每回合抽牌 | 5 |

### 3.2 初始资源

- **初始金币**：99
- **初始遗物**：永燃心脏
- **初始牌组（13 张）**：
  - 凝视之触 × 4
  - 灰雾护盾 × 4
  - 深渊重锤 × 1
  - 触须鞭笞 × 1
  - 躯壳硬化 × 1
  - 禁忌献祭 × 1
  - 窒息缠绕 × 1

---

## 4. 战斗系统（多敌人）

### 4.1 胜负条件

- **胜利**：所有敌人 HP 降至 0。
- **失败**：玩家 HP 降至 0。

### 4.2 回合流程（触发顺序）

#### 回合开始（玩家回合开始）

- 能量恢复到 3
- 玩家格挡清零
- 抽 5 张牌
- 显示每个敌人的意图（下一回合敌人将执行的行动）

#### 玩家阶段

- 玩家可以重复执行：
  - 打出手牌（消耗能量）
  - 或结束回合

#### 回合结束（玩家结束回合后）

- 弃掉所有手牌
- 所有存活敌人依次执行行动
- 进入下一回合

### 4.3 牌堆机制

- **抽牌堆**：回合开始抽牌来源
- **手牌**：当前可用
- **弃牌堆**：打出/弃置的牌进入这里
- **洗牌触发**：当抽牌堆为空时，弃牌堆洗回抽牌堆

### 4.4 敌人池（各 Act 敌人数值）

#### Act 1

| 类型 | 敌人名（v0.1） | 原名 | HP 范围 |
|------|---------------|------|---------|
| 普通 | 咀嚼者 | 下颚虫 | 40~44 |
| 普通 | 虔信者 | 信徒 | 48~54 |
| 普通 | 翠鳞虫 | 绿虱子 | 11~17 |
| 普通 | 血眼虫 | 红虱子 | 10~15 |
| 普通 | 腐菌体 | 孢子兽 | 24~28 |
| 普通 | 溶蚀幼崽 | 酸液幼体 | 20~24 |
| 精英 | 深渊黏体 | 酸液史莱姆 | 28~32 |
| 精英 | 沉默守墓人 | 岩石守卫 | 60~66 |
| Boss | 瘴气之主 | 毒雾巨像 | 95~105 |

#### Act 2

| 类型 | 敌人名（v0.1） | 原名 | HP 范围 |
|------|---------------|------|---------|
| 普通 | 虚影猎手 | 幽影刺客 | 32~36 |
| 普通 | 铭文傀儡 | 机械哨兵 | 36~40 |
| 精英 | 符文执行者 | 符文守卫 | 70~76 |
| Boss | 窥视者 | 时空观测者 | 110~120 |

#### Act 3（v0.1 新增）

| 类型 | 敌人名（v0.1） | HP 范围 | 说明 |
|------|---------------|---------|------|
| 普通 | 虚无行者 | 42~48 | 来自虚无之心的生物 |
| 普通 | 梦境寄生者 | 28~34 | 寄生在梦境中的怪物 |
| 精英 | 循环守卫 | 85~95 | 守护序列始祖的存在 |
| Boss | 序列始祖 | 150~170 | 循环的根源，最终 Boss |

### 4.5 遭遇池（多敌人战斗）

- **普通战斗**可能出现 **1 或 2 个敌人** 同场
- **已接入的多敌人遭遇**：
  - Act 1：翠鳞虫 + 血眼虫 / 虔信者 × 2 / 咀嚼者 + 翠鳞虫
  - Act 2：虚影猎手 + 铭文傀儡 / 铭文傀儡 × 2
  - Act 3：虚无行者 + 梦境寄生者 / 梦境寄生者 × 2 / 虚无行者 × 2

---

## 5. 伤害、格挡与状态效果

### 5.1 伤害与格挡结算

伤害结算顺序：

1. 力量加成：伤害 + 力量值
2. 虚弱减伤：伤害 × 0.75（向下取整）
3. 易伤增伤：伤害 × 1.5（向下取整）
4. 伤害先被格挡吸收
5. 超出格挡的部分扣除 HP

格挡规则：

- 玩家格挡在**每回合开始时清零**。

### 5.2 状态效果（当前已实现的规则）

| 效果 | 说明 | 持续 |
|------|------|------|
| 易伤（Vulnerable） | 受到伤害 +50% | 每回合 -1 |
| 虚弱（Weak） | 造成伤害 -25% | 每回合 -1 |
| 脆弱（Frail） | 获得格挡 -25% | 每回合 -1 |
| 中毒（Poison） | 回合结束造成等量伤害，再 -1 层 | 递减 |
| 力量（Strength） | 攻击伤害 +N | 永久 |
| 敏捷（Dexterity） | 获得格挡 +N | 永久 |

中毒触发：

- **触发：回合结束** → 造成“当前中毒层数”点伤害，然后中毒层数 -1。

---

## 6. 卡牌系统（当前卡池与升级）

### 6.1 卡牌列表（当前版本）

| 卡牌名（v0.1） | 原名 | 费用 | 效果 | 风味 |
|---------------|------|------|------|------|
| 凝视之触 | 打击 | 1 | 造成 6 伤害 | 以目光为刃 |
| 灰雾护盾 | 防御 | 1 | 获得 5 格挡 | 召唤迷雾庇护 |
| 深渊重锤 | 重击 | 2 | 造成 8 伤害，给予易伤 2 | 自深渊汲取力量 |
| 触须鞭笞 | 柄击 | 1 | 造成 9 伤害，抽 1 张牌 | 灵活而致命 |
| 躯壳硬化 | 耸肩 | 1 | 获得 8 格挡，抽 1 张牌 | 身体短暂石化 |
| 禁忌献祭 | 燃烧 | 1 | 获得 2 力量 | 以理智换取力量 |
| 窒息缠绕 | 晾衣绳 | 2 | 造成 12 伤害，给予虚弱 2 | 来自虚空的束缚 |
| 裂隙横断 | 横扫 | 1 | 对所有敌人造成 4 伤害 | 撕裂空间的一击 |
| 疯狂低语 | 威吓 | 1 | 使所有敌人获得虚弱 2 | 令敌人精神崩溃 |
| 虚空步 | 敏捷姿态 | 1 | 获得 1 敏捷 | 踏入另一维度 |
| 腐蚀之触 | 淬毒打击 | 1 | 造成 5 伤害，给予中毒 2 | 沾染远古毒素 |

### 6.2 休息点升级（触发与规则）

- **触发：进入休息点**
  - 选项 A：回血（见“休息点系统”）
  - 选项 B：升级卡牌（若存在可升级卡）
- **升级效果**：
  - 选择一张可升级卡牌，将其升级为对应的"+"版本。
  - 当前已可升级的起始牌：凝视之触 / 灰雾护盾 / 深渊重锤。

### 6.3 卡池（卡牌来源）

- **起始牌池（含升级版）**：凝视之触 / 凝视之触+ / 灰雾护盾 / 灰雾护盾+ / 深渊重锤 / 深渊重锤+
- **奖励 / 商店 / 事件可获得卡池（非起始卡）**：触须鞭笞、躯壳硬化、禁忌献祭、窒息缠绕、裂隙横断、疯狂低语、虚空步、腐蚀之触

---

## 7. 奖励系统（战斗胜利后的成长）

### 7.1 金币奖励（触发与范围）

- **触发：普通战斗胜利** → 获得金币 **10 ~ 20**
- **触发：精英战斗胜利** → 获得金币 **25 ~ 35**

### 7.2 卡牌奖励（触发与规则）

- **触发：普通战斗胜利 / 精英战斗胜利**
  - 进入“战斗奖励”界面
  - 展示 3 张可选卡牌（来自非起始卡池）
  - 玩家可 **选择 1 张加入牌组** 或 **跳过**

---

## 8. 商店系统（买卡 / 删牌）

### 8.1 商店库存（触发）

- **触发：进入商店房间**
  - 商店提供 **3 张可购买卡牌**（来自非起始卡池）
  - 商店提供 **删牌服务**（从牌组移除 1 张牌）

### 8.2 价格规则

- 买卡价格（按稀有度）：
  - 起始：30（当前不会出现在商店）
  - 普通：45
  - 罕见：75
  - 稀有：150
- 删牌服务：75

### 8.3 购买与删牌规则

- **购买卡牌**：
  - 金币足够时才能购买
  - 购买后卡牌加入牌组，商店对应卡牌从库存移除
- **删牌服务**：
  - 金币足够时才能删牌
  - 选择牌组中任意 1 张牌移除

---

## 9. 事件系统（事件房间）

### 9.1 事件节点（地图展示）

- 地图上会出现 **“？”** 节点，表示“未知事件”。
- 玩家在地图选择节点时，会看到该节点类型为“未知事件”（进入后才会揭示具体事件内容）。

### 9.2 进入事件（触发与流程）

- **触发：进入事件房间**
  - 展示事件名称与描述（v0.1：以剧情事件/NPC 对话/世界观碎片为主）
  - 展示多个可选项（通常包含“离开”）
  - 玩家选择 1 个选项后，立即结算并对本次冒险产生影响（金币/HP/卡牌/遗物等）
  - 部分选项需要 **二次选择**（例如：从可升级卡中选 1 张进行升级）

### 9.3 当前事件列表（v0.1 剧情化）

| 事件 | 选项示例 | 可能影响 |
|------|----------|----------|
| 流浪者的低语（原：拾荒者）👻 | 接过东西 / 询问故事 / 转身离开 | 获得金币；或失去 HP（精神冲击）换更多金币 |
| 序列祭坛（原：祭坛）🗿 | 献上供奉 / 触碰符文祈祷 / 保持距离离开 | 失去金币获得遗物；或回复 HP |
| 尼古拉的指导（原：训练）🤝 | 接受指导 / 请传授新招 / 谢绝好意继续前进 | 升级卡牌；或获得卡牌 |

### 9.4 事件池（当前可出现）

- 流浪者的低语（原：拾荒者）
- 序列祭坛（原：祭坛）
- 尼古拉的指导（原：训练）

---

## 10. 休息点系统（回血 / 升级）

### 10.1 回血

- **触发：进入休息点并选择“休息”**  
  - 回复 **30% 最大生命值**（不超过最大生命）

### 10.2 升级

- **触发：进入休息点并选择“升级卡牌”**  
  - 从可升级卡中选择 1 张进行升级（若当前没有可升级卡则不可选）

---

## 11. 遗物系统（获得、展示与触发）

### 11.1 遗物获取（触发）

- **触发：冒险开始** → 获得起始遗物：永燃心脏
- **触发：精英战斗胜利** → 掉落 1 个遗物（可选择获得或跳过；不会重复掉落已拥有遗物；不会掉落起始遗物）
- **触发：Boss 战斗胜利** → 掉落 1 个遗物（可选择获得或跳过；同样不重复、不掉落起始遗物）

### 11.2 遗物展示

- 地图界面与战斗界面都会显示“已持有遗物”（至少 icon + 名称）。

### 11.3 当前遗物列表与触发时机

| 遗物名（v0.1） | 原名 | 效果 | 触发 | 风味 |
|---------------|------|------|------|------|
| 永燃心脏 | 燃烧之血 | 战斗胜利后恢复 6 点生命 | 战斗结束（胜利） | 不死者的馈赠 |
| 远古骨锤 | 金刚杵 | 战斗开始时获得 1 点力量 | 战斗开始 | 古神遗骸制成 |
| 幽冥灯火 | 灯笼 | 战斗开始时获得 1 点能量 | 战斗开始 | 照亮彼岸之路 |
| 鳞甲残片 | 铁护臂 | 每次打出攻击牌，获得 2 点格挡 | 打出攻击牌 | 沉睡巨兽的鳞片 |
| 夜鸦羽翼 | 羽披风 | 战斗开始时获得 1 点敏捷 | 战斗开始 | 来自无名之鸟 |
| 血誓旗帜 | 战旗 | 战斗开始时获得 2 点力量 | 战斗开始 | 浸染无数亡魂 |
| 始祖碎片 | 巨像核心 | 战斗开始时，使所有敌人获得中毒 3 | 战斗开始 | 序列始祖的一部分 |

### 11.4 遗物池（当前版本）

- **起始遗物**：永燃心脏
- **可掉落遗物（精英/Boss）**：远古骨锤、幽冥灯火、鳞甲残片、夜鸦羽翼、血誓旗帜、始祖碎片

---

## 12. 战绩、统计与存档系统

### 12.1 战绩系统（触发）

- **触发：每次战斗结束**  
  - 自动记录胜负、回合数、使用卡牌统计、伤害/格挡统计

### 12.2 统计系统

- 统计界面用于汇总展示多场战斗的累计数据（例如总伤害、总格挡、卡牌使用次数等）。

### 12.3 存档系统（触发）

- **触发：每个节点完成后** → 自动保存冒险进度
- **触发：主菜单进入冒险** → 若存在存档，可选择继续上次冒险
- **触发：冒险结束（胜利/失败）** → 当前存档被清除

---

## 13. 操作与界面（玩家输入）

### 13.1 主菜单

- 根据是否存在存档，主菜单会提供“继续上次冒险 / 开始新冒险 / 设置 / 退出”等入口。

### 13.2 地图界面

- 输入 `1-N`：选择可进入的节点
- 输入 `abandon`：放弃当前冒险（需确认）
- （调试）日志会同步写入 `run_log.txt`（位于游戏数据目录）
- 输入 `q`：返回主菜单（保存进度）

### 13.3 战斗界面

- 输入 `1-n`：打出第 n 张手牌（不需要目标 / 仅 1 个存活敌人时）
- 输入 `n m`：打出第 n 张手牌，目标为第 m 个敌人（当该牌需要目标且有多个存活敌人时，m 从 1 开始）
- 输入 `0`：结束回合
- 输入 `q`：返回主菜单（保存进度）

### 13.4 设置菜单

- 输入 `1`：查看历史记录
- 输入 `2`：查看战绩统计
- 输入 `3`：清除历史记录
- 输入 `4`：资源管理（查看卡牌/敌人/遗物注册表与关键池子统计）
- 输入 `5`：游戏帮助
- 输入 `6`：日志显示开关（持久化设置，重启游戏后仍保持）
- 输入 `0`：返回主菜单

### 13.5 资源管理页

- 一次性输出全量内容（卡牌/敌人/遭遇/遗物注册表）

---

## 14. Roadmap / 后续扩展方向（1.0 / 2.0）

> 本节用于把"玩法/业务规则说明"与"版本里程碑"对齐；具体执行细节以 `.cursor/plans/*.md` 为准。

### 14.1 版本里程碑（最新确认）

- **设定（v0.1）**：卡牌 Roguelike + 碎片叙事；克苏鲁 / 神秘学风格；通关即结局。`.cursor/plans/Salu 游戏设计方案（v0 1） .md`
- **1.0（长期运营版）**：以 `GameCore + GameCLI` 为核心交付，内容足够、难度阶梯、多角色/多模式/成就/本地存档齐备，可持续扩展。`.cursor/plans/长期演进的完整游戏.md`
- **2.0（Apps）**：在 1.0 稳定后，再做 **macOS App + visionOS App**（原生 UI、i18n、签名/上架链路）。`.cursor/plans/plan-a-2.0-macos-swiftui.md`
