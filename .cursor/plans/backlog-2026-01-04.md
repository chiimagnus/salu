# 后续可做内容 / 未接入系统清单（Backlog）- 2026-01-04

> 目的：回答“哪些系统还没加入到游戏里？”以及“后续还能做什么？”  
> 说明：本清单以当前代码实现为准（P1~P7 架构已落地），重点列出 **玩法闭环缺口** 与 **已实现但未接入的能力**。

## 一、确认：确实有一些系统尚未加入到游戏玩法中 ✅

目前游戏已经具备：冒险地图 → 房间流程 → 战斗 → 历史/统计 → Run 存档/继续冒险 的主干闭环。  
但《杀戮尖塔》式的核心成长循环（**战斗胜利 → 奖励/卡组变化 → 商店/事件 → 遗物/升级**）仍缺失或未接入。

## 二、未接入 / 缺失的主要系统（按“影响体验”排序）

### 1) 战斗后奖励系统（卡牌 3 选 1 + 加入牌组）

- **现状**：战斗胜利后直接回地图；牌组不会增长/变形
- **目标**：战斗胜利后弹出奖励界面：3 选 1 卡牌 → 选择后加入 `RunState.deck`
- **涉及模块**：
  - GameCore：需要卡池（CardPool）/奖励生成（RewardGenerator）/发放策略（稀有度权重）
  - GameCLI：新增 `RewardScreen`；在 `BattleRoomHandler/EliteRoomHandler` 胜利后插入奖励流程

### 2) 金币与商店系统（买卡/删卡）

- **现状**：RunState 没有金币；地图没有商店节点
- **目标**：
  - 战斗奖励发金币
  - 商店房间：购买卡牌 / 移除卡牌（删牌）
- **涉及模块**：
  - GameCore：RunState 增加 gold；商店定价模型；ShopInventory 生成
  - GameCLI：ShopScreen + RoomType.shop + ShopRoomHandler

### 3) 休息点扩展：升级卡牌（利用 `upgradedId`）

- **现状**：休息点只有“回复 30% HP”
- **目标**：休息点提供分支：回复 或 升级卡牌（从 deck 选择一张可升级卡，将 cardId 替换为 upgradedId）
- **涉及模块**：
  - GameCore：CardDefinition.upgradedId 已存在，但缺少“升级动作”的通用逻辑与 UI 入口
  - GameCLI：RestScreen 增加选择与卡牌列表展示

### 4) 遗物获取（精英/Boss 掉落）+ 遗物展示

- **现状**：遗物系统与触发已具备，但 Run 里只固定给起始遗物；没有“获得遗物”的玩法入口
- **目标**：
  - 精英胜利：掉落遗物（随机/可选）
  - Boss 胜利：Boss 遗物（可选）
  - 战斗界面/地图界面显示已持有遗物
- **涉及模块**：
  - GameCore：RelicPool/掉落规则
  - GameCLI：RelicRewardScreen；在 Elite/Boss handler 中接入

### 5) 事件房间（随机事件 + 选项）

- **现状**：没有 event room type；没有 Run-level effect（金币/卡牌/遗物/HP 的非战斗来源）
- **目标**：事件房间：展示事件 → 多选项 → 产生 RunEffect（获得卡、获得金币、丢血、获得遗物等）
- **涉及模块**：
  - GameCore：需要 RunEffect/RunTrigger（把 battle 与 run 分离）
  - GameCLI：EventScreen + EventRoomHandler

### 6) 多敌人战斗 + 目标选择

- **现状**：BattleState 仅支持单敌人；UI 与输入也只支持单目标
- **目标**：BattleState 支持 `[Entity]` 敌人；CardEffect/BattleEffect 支持目标选择；UI 支持选目标
- **影响**：属于架构级变更（工作量大），建议在奖励/商店/升级闭环完成后再做

### 7) 内容扩展：更多敌人/精英/Boss/Act2

- **现状**：Act1 敌人 5 个；Boss 房间目前复用普通敌人
- **目标**：至少补一个真正的 Boss 定义（独特 HP/技能循环），再逐步扩 Act2

### 8) AI 集成（玩家助手/自动对战/文本生成）

- **现状**：AI 相关接口未实现
- **目标**：AIProvider + Mock → 再逐步接入外部/本地 LLM

## 三、已实现但“未被玩法使用”的能力（可作为接入切入点）

- **状态系统**：`Frail/Poison/Dexterity` 已实现定义，但目前没有卡牌/敌人/遗物会赋予它们（等接入内容后自然会用到）
- **卡牌升级**：`CardDefinition.upgradedId` 已存在，但没有“升级动作/界面”
- **遗物触发点**：BattleTrigger 已齐全，但遗物获取未接入
- **MapGenerating**：接口已具备，但 Run 开局还没有“按 Act/难度注入策略”的入口（可后续扩展）

## 四、推荐的下一阶段顺序（建议）

如果你希望最快形成“杀戮尖塔式成长体验”，推荐：

1. **A：战斗后奖励（卡牌 3 选 1 + 入牌组）**
2. **B：金币 + 商店（买卡/删卡）**
3. **C：休息点升级卡牌**
4. **D：精英/Boss 遗物掉落与展示**
5. **E：事件房间（RunEffect/事件 UI）**
6. **F：多敌人战斗 + 目标选择**
7. **G：Act2/更多内容**
